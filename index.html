<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Barcode Scanner</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
body { font-family: Arial; text-align: center; padding:20px; }
#reader { width: 300px; margin:auto; }
table { margin:20px auto; border-collapse:collapse; }
td, th { border:1px solid #ccc; padding:8px; }
button { padding:10px; margin:5px; cursor:pointer; }
</style>
</head>
<body>

<h2>ðŸ“· Barcode Scanner</h2>
<div id="reader"></div>

<h3>Scanned Codes</h3>
<table id="dataTable">
<tr><th>#</th><th>Barcode</th><th>Time</th></tr>
</table>

<button onclick="downloadCSV()">Download Excel File</button>

<script>
let count = 0;
let scanned = [];

function onScanSuccess(decodedText) {
  count++;
  const time = new Date().toLocaleString();
  scanned.push([count, decodedText, time]);

  const table = document.getElementById("dataTable");
  const row = table.insertRow();
  row.insertCell(0).innerText = count;
  row.insertCell(1).innerText = decodedText;
  row.insertCell(2).innerText = time;
}

const scanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 });
scanner.render(onScanSuccess);

function downloadCSV() {
  let csv = "No,Barcode,Time\n";
  scanned.forEach(row => csv += row.join(",") + "\n");
  const blob = new Blob([csv], { type: "text/csv" });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "barcodes.csv";
  a.click();
}
</script>

</body>
</html>